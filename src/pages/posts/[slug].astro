---
import readingTime from 'reading-time';
import PostLayout from '../../layouts/PostLayout.astro';

export async function getStaticPaths({}) {
  let allPosts = await Astro.glob('../../posts/**/*.md');
  let allSortedPosts = allPosts.sort(
    // @ts-ignore
    (a, b) => new Date(b.frontmatter.pubDate) - new Date(a.frontmatter.pubDate)
  );

  return allSortedPosts.map((post) => {
    return {
      params: { slug: post.frontmatter.slug },
      props: { post },
    };
  });
}

const { post } = Astro.props;
---

<PostLayout
  title={post.frontmatter.title}
  description={post.frontmatter.description}
  heroImage={post.frontmatter.heroImage}
  fileName={post.file.slice(post.file.lastIndexOf('/'))}
  pubDate={post.frontmatter.pubDate}
  readTime={readingTime(post.rawContent()).text}
>
  <post.Content></post.Content>
</PostLayout>
